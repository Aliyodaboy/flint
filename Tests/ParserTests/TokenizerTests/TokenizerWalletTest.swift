//
//  TokenizerWalletTest.swift
//  TokenizerWalletTest
//
//  Created by Franklin Schrans on 12/19/17.
//

import XCTest
import Parser
import AST
import Diagnostic

class TokenizerWalletTest: XCTestCase, TokenizerTest {

  var sourceCode: String =
  """
  contract Wallet {
    var owner: Address
    var contents: Ether
  }

  Wallet :: (any) {
    public mutating func deposit(money: Ether) {
      contents = contents + money;
    }
  }

  Wallet :: (owner) {
    public mutating func withdraw(money: Ether) {
      contents = contents - money;
    }

    public func getContents() -> Ether {
      return contents;
    }
  }

  """

  var expectedTokens: [Token] = [AST.Token(kind: AST.Token.Kind.contract, sourceLocation: SourceLocation(line: 1, column: 1, length: 8)), AST.Token(kind: AST.Token.Kind.identifier("Wallet"), sourceLocation: SourceLocation(line: 1, column: 10, length: 6)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBrace), sourceLocation: SourceLocation(line: 1, column: 17, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 1, column: 18, length: 1)), AST.Token(kind: AST.Token.Kind.var, sourceLocation: SourceLocation(line: 2, column: 3, length: 3)), AST.Token(kind: AST.Token.Kind.identifier("owner"), sourceLocation: SourceLocation(line: 2, column: 7, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.colon), sourceLocation: SourceLocation(line: 2, column: 12, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Address"), sourceLocation: SourceLocation(line: 2, column: 14, length: 7)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 2, column: 21, length: 1)), AST.Token(kind: AST.Token.Kind.var, sourceLocation: SourceLocation(line: 3, column: 3, length: 3)), AST.Token(kind: AST.Token.Kind.identifier("contents"), sourceLocation: SourceLocation(line: 3, column: 7, length: 8)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.colon), sourceLocation: SourceLocation(line: 3, column: 15, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Ether"), sourceLocation: SourceLocation(line: 3, column: 17, length: 5)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 3, column: 22, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBrace), sourceLocation: SourceLocation(line: 4, column: 1, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 4, column: 2, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 5, column: 1, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Wallet"), sourceLocation: SourceLocation(line: 6, column: 1, length: 6)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.doubleColon), sourceLocation: SourceLocation(line: 6, column: 8, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBracket), sourceLocation: SourceLocation(line: 6, column: 10, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("any"), sourceLocation: SourceLocation(line: 6, column: 11, length: 3)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBracket), sourceLocation: SourceLocation(line: 6, column: 14, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBrace), sourceLocation: SourceLocation(line: 6, column: 16, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 6, column: 17, length: 1)), AST.Token(kind: AST.Token.Kind.public, sourceLocation: SourceLocation(line: 7, column: 3, length: 6)), AST.Token(kind: AST.Token.Kind.mutating, sourceLocation: SourceLocation(line: 7, column: 10, length: 8)), AST.Token(kind: AST.Token.Kind.func, sourceLocation: SourceLocation(line: 7, column: 19, length: 4)), AST.Token(kind: AST.Token.Kind.identifier("deposit"), sourceLocation: SourceLocation(line: 7, column: 24, length: 7)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBracket), sourceLocation: SourceLocation(line: 7, column: 31, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("money"), sourceLocation: SourceLocation(line: 7, column: 32, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.colon), sourceLocation: SourceLocation(line: 7, column: 37, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Ether"), sourceLocation: SourceLocation(line: 7, column: 39, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBracket), sourceLocation: SourceLocation(line: 7, column: 44, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBrace), sourceLocation: SourceLocation(line: 7, column: 46, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 7, column: 47, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("contents"), sourceLocation: SourceLocation(line: 8, column: 5, length: 8)), AST.Token(kind: AST.Token.Kind.binaryOperator(AST.Token.Kind.BinaryOperator.equal), sourceLocation: SourceLocation(line: 8, column: 14, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("contents"), sourceLocation: SourceLocation(line: 8, column: 16, length: 8)), AST.Token(kind: AST.Token.Kind.binaryOperator(AST.Token.Kind.BinaryOperator.plus), sourceLocation: SourceLocation(line: 8, column: 25, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("money"), sourceLocation: SourceLocation(line: 8, column: 27, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.semicolon), sourceLocation: SourceLocation(line: 8, column: 32, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 8, column: 33, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBrace), sourceLocation: SourceLocation(line: 9, column: 3, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 9, column: 4, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBrace), sourceLocation: SourceLocation(line: 10, column: 1, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 10, column: 2, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 11, column: 1, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Wallet"), sourceLocation: SourceLocation(line: 12, column: 1, length: 6)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.doubleColon), sourceLocation: SourceLocation(line: 12, column: 8, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBracket), sourceLocation: SourceLocation(line: 12, column: 10, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("owner"), sourceLocation: SourceLocation(line: 12, column: 11, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBracket), sourceLocation: SourceLocation(line: 12, column: 16, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBrace), sourceLocation: SourceLocation(line: 12, column: 18, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 12, column: 19, length: 1)), AST.Token(kind: AST.Token.Kind.public, sourceLocation: SourceLocation(line: 13, column: 3, length: 6)), AST.Token(kind: AST.Token.Kind.mutating, sourceLocation: SourceLocation(line: 13, column: 10, length: 8)), AST.Token(kind: AST.Token.Kind.func, sourceLocation: SourceLocation(line: 13, column: 19, length: 4)), AST.Token(kind: AST.Token.Kind.identifier("withdraw"), sourceLocation: SourceLocation(line: 13, column: 24, length: 8)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBracket), sourceLocation: SourceLocation(line: 13, column: 32, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("money"), sourceLocation: SourceLocation(line: 13, column: 33, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.colon), sourceLocation: SourceLocation(line: 13, column: 38, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Ether"), sourceLocation: SourceLocation(line: 13, column: 40, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBracket), sourceLocation: SourceLocation(line: 13, column: 45, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBrace), sourceLocation: SourceLocation(line: 13, column: 47, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 13, column: 48, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("contents"), sourceLocation: SourceLocation(line: 14, column: 5, length: 8)), AST.Token(kind: AST.Token.Kind.binaryOperator(AST.Token.Kind.BinaryOperator.equal), sourceLocation: SourceLocation(line: 14, column: 14, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("contents"), sourceLocation: SourceLocation(line: 14, column: 16, length: 8)), AST.Token(kind: AST.Token.Kind.binaryOperator(AST.Token.Kind.BinaryOperator.minus), sourceLocation: SourceLocation(line: 14, column: 25, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("money"), sourceLocation: SourceLocation(line: 14, column: 27, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.semicolon), sourceLocation: SourceLocation(line: 14, column: 32, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 14, column: 33, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBrace), sourceLocation: SourceLocation(line: 15, column: 3, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 15, column: 4, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 16, column: 1, length: 1)), AST.Token(kind: AST.Token.Kind.public, sourceLocation: SourceLocation(line: 17, column: 3, length: 6)), AST.Token(kind: AST.Token.Kind.func, sourceLocation: SourceLocation(line: 17, column: 10, length: 4)), AST.Token(kind: AST.Token.Kind.identifier("getContents"), sourceLocation: SourceLocation(line: 17, column: 15, length: 11)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBracket), sourceLocation: SourceLocation(line: 17, column: 26, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBracket), sourceLocation: SourceLocation(line: 17, column: 27, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.arrow), sourceLocation: SourceLocation(line: 17, column: 29, length: 1)), AST.Token(kind: AST.Token.Kind.identifier("Ether"), sourceLocation: SourceLocation(line: 17, column: 31, length: 5)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.openBrace), sourceLocation: SourceLocation(line: 17, column: 37, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 17, column: 38, length: 1)), AST.Token(kind: AST.Token.Kind.return, sourceLocation: SourceLocation(line: 18, column: 5, length: 6)), AST.Token(kind: AST.Token.Kind.identifier("contents"), sourceLocation: SourceLocation(line: 18, column: 12, length: 8)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.semicolon), sourceLocation: SourceLocation(line: 18, column: 20, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 18, column: 21, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBrace), sourceLocation: SourceLocation(line: 19, column: 3, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 19, column: 4, length: 1)), AST.Token(kind: AST.Token.Kind.punctuation(AST.Token.Kind.Punctuation.closeBrace), sourceLocation: SourceLocation(line: 20, column: 1, length: 1)), AST.Token(kind: AST.Token.Kind.newline, sourceLocation: SourceLocation(line: 20, column: 2, length: 1))]

  func testWallet() {
    test()
  }
}
